<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Advanced Feedback Form</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f5f7fa;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      padding: 20px;
    }
    form {
      background: #fff;
      padding: 20px;
      border-radius: 12px;
      width: 400px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      display: flex;
      flex-direction: column;
      gap: 15px;
    }
    h2 {
      text-align: center;
      color: #333;
    }
    label {
      font-weight: bold;
      margin-bottom: 5px;
    }
    input, select, textarea {
      width: 100%;
      padding: 10px;
      border-radius: 6px;
      border: 1px solid #ccc;
      font-size: 14px;
    }
    button {
      padding: 12px;
      background: #007bff;
      border: none;
      border-radius: 6px;
      color: #fff;
      font-size: 16px;
      cursor: pointer;
    }
    button:hover {
      background: #0056b3;
    }
    .error {
      color: red;
      font-size: 13px;
    }
    .success {
      color: green;
      font-size: 14px;
      text-align: center;
    }
  </style>
</head>
<body>
  <form id="feedbackForm">
    <h2>Feedback Form</h2>

    <div>
      <label for="name">Name:</label>
      <input type="text" id="name" name="name">
      <div id="nameError" class="error"></div>
    </div>

    <div>
      <label for="email">Email:</label>
      <input type="email" id="email" name="email">
      <div id="emailError" class="error"></div>
    </div>

    <div>
      <label for="event">Event Attended:</label>
      <select id="event" name="event">
        <option value="">-- Select Event --</option>
        <option value="Webinar">Webinar</option>
        <option value="Workshop">Workshop</option>
        <option value="Meetup">Meetup</option>
      </select>
      <div id="eventError" class="error"></div>
    </div>

    <div>
      <label>Rating (1â€“5):</label>
      <select id="rating" name="rating">
        <option value="">-- Select Rating --</option>
        <option value="1">1</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5</option>
      </select>
      <div id="ratingError" class="error"></div>
    </div>

    <div>
      <label for="comments">Comments:</label>
      <textarea id="comments" name="comments" rows="4"></textarea>
      <div id="commentsError" class="error"></div>
    </div>

    <button type="submit">Submit</button>
    <div id="formMessage"></div>
  </form>

  <script>
    class FeedbackFormHandler {
      constructor(formId) {
        this.form = document.getElementById(formId);

        // Error + Message elements
        this.errors = {
          name: document.getElementById("nameError"),
          email: document.getElementById("emailError"),
          event: document.getElementById("eventError"),
          rating: document.getElementById("ratingError"),
          comments: document.getElementById("commentsError"),
        };
        this.messageBox = document.getElementById("formMessage");

        // Event Listeners
        this.form.addEventListener("submit", (e) => this.handleSubmit(e));
        this.form.addEventListener("input", (e) => this.handleRealTimeValidation(e));
        this.form.addEventListener("blur", (e) => this.handleRealTimeValidation(e), true);
      }

      // Validate entire form
      validateForm() {
        let isValid = true;

        // Name
        const name = this.form.name.value.trim();
        if (name.length < 3) {
          this.errors.name.textContent = "Name must be at least 3 characters.";
          isValid = false;
        } else {
          this.errors.name.textContent = "";
        }

        // Email
        const email = this.form.email.value.trim();
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        if (!emailRegex.test(email)) {
          this.errors.email.textContent = "Enter a valid email address.";
          isValid = false;
        } else {
          this.errors.email.textContent = "";
        }

        // Event
        const eventSelected = this.form.event.value;
        if (!eventSelected) {
          this.errors.event.textContent = "Please select an event.";
          isValid = false;
        } else {
          this.errors.event.textContent = "";
        }

        // Rating
        const rating = parseInt(this.form.rating.value);
        if (isNaN(rating) || rating < 1 || rating > 5) {
          this.errors.rating.textContent = "Please select a rating between 1 and 5.";
          isValid = false;
        } else {
          this.errors.rating.textContent = "";
        }

        // Comments
        const comments = this.form.comments.value.trim();
        if (comments.length < 10) {
          this.errors.comments.textContent = "Comments must be at least 10 characters.";
          isValid = false;
        } else {
          this.errors.comments.textContent = "";
        }

        return isValid;
      }

      // Real-time validation (on input/blur)
      handleRealTimeValidation(e) {
        if (["name", "email", "event", "rating", "comments"].includes(e.target.name)) {
          this.validateForm();
        }
      }

      // Save valid feedback to localStorage
      saveToLocalStorage() {
        const feedback = {
          name: this.form.name.value.trim(),
          email: this.form.email.value.trim(),
          event: this.form.event.value,
          rating: this.form.rating.value,
          comments: this.form.comments.value.trim(),
        };

        let feedbacks = JSON.parse(localStorage.getItem("feedbacks")) || [];
        feedbacks.push(feedback);
        localStorage.setItem("feedbacks", JSON.stringify(feedbacks));
      }

      // Clear form
      clearForm() {
        this.form.reset();
      }

      // Show feedback message
      showMessage(msg, type = "success") {
        this.messageBox.textContent = msg;
        this.messageBox.className = type;
        setTimeout(() => {
          this.messageBox.textContent = "";
          this.messageBox.className = "";
        }, 3000);
      }

      // Handle submit
      handleSubmit(e) {
        e.preventDefault();
        if (this.validateForm()) {
          this.saveToLocalStorage();
          this.showMessage("Feedback submitted successfully!", "success");
          this.clearForm();
        } else {
          this.showMessage("Please fix the errors before submitting.", "error");
        }
      }
    }

    // Initialize handler
    const feedbackForm = new FeedbackFormHandler("feedbackForm");
  </script>
</body>
</html>

